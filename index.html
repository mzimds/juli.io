<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DONTMED- Sistema de Plantão Médico</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: #2c7da0;
            --primary-dark: #1a5276;
            --secondary: #468faf;
            --light: #ffffff;
            --dark: #333333;
            --darker: #222222;
            --danger: #e74c3c;
            --success: #2ecc71;
            --warning: #f39c12;
            --pass-plantao: #2ecc71;
            --gray: #95a5a6;
            --light-gray: #f5f5f5;
            --border: rgba(0, 0, 0, 0.1);
            --sidebar-width: 280px;
            --header-height: 60px;
            --shadow-sm: 0 1px 3px rgba(0,0,0,0.08);
            --shadow-md: 0 4px 6px rgba(0,0,0,0.05);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
        }

        body {
            background: var(--light);
            color: var(--dark);
            height: 100vh;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        .card {
            background: var(--light);
            border: 1px solid var(--border);
            box-shadow: var(--shadow-sm);
            border-radius: 8px;
        }

        header {
            height: var(--header-height);
            background: var(--light);
            color: var(--darker);
            padding: 0 15px;
            display: flex;
            align-items: center;
            position: relative;
            z-index: 100;
            box-shadow: var(--shadow-sm);
            border-bottom: 1px solid var(--border);
        }

        .logo {
            font-weight: 700;
            font-size: 1.5rem;
            letter-spacing: -0.5px;
            font-family: 'Inter', sans-serif;
            font-weight: 800;
            margin-right: auto;
            color: var(--darker);
        }

        .header-info {
            display: flex;
            align-items: center;
            gap: 15px;
            font-size: 0.9rem;
            color: var(--dark);
        }

        .container {
            display: flex;
            flex: 1;
            overflow: hidden;
            padding: 12px;
            gap: 12px;
            background: var(--light-gray);
        }

        .sidebar {
            width: var(--sidebar-width);
            display: flex;
            flex-direction: column;
            overflow: hidden;
            transition: transform 0.3s ease;
        }

        .section-header {
            padding: 15px 15px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px solid var(--border);
        }

        .section-title {
            font-weight: 600;
            color: var(--darker);
            font-size: 1.1rem;
        }

        .btn {
            padding: 8px 12px;
            background: var(--darker);
            color: white;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.9rem;
            transition: all 0.2s ease;
            font-weight: 500;
            box-shadow: var(--shadow-sm);
        }

        .btn:hover {
            background: var(--dark);
            transform: translateY(-1px);
            box-shadow: var(--shadow-md);
        }

        .btn:active {
            transform: translateY(0);
        }

        .btn-danger {
            background: var(--danger);
        }

        .btn-success {
            background: var(--success);
        }

        .btn-pass {
            background: var(--pass-plantao);
        }

        .search-container {
            padding: 12px;
            border-bottom: 1px solid var(--border);
        }

        .search-box {
            position: relative;
        }

        .search-box input {
            width: 100%;
            padding: 10px 12px;
            border: 1px solid var(--border);
            border-radius: 6px;
            font-size: 0.95rem;
            background: var(--light);
            transition: all 0.2s ease;
            font-family: 'Inter', sans-serif;
            box-shadow: var(--shadow-sm);
        }

        .search-box input:focus {
            background: white;
            box-shadow: 0 0 0 2px rgba(44, 125, 160, 0.2);
            outline: none;
            border-color: var(--primary);
        }

        .scrollable-content {
            flex: 1;
            overflow-y: auto;
            padding: 8px 0;
        }

        .setor-item {
            padding: 12px 15px;
            cursor: pointer;
            transition: background-color 0.2s;
            border-left: 3px solid transparent;
            margin: 8px 0;
            border-radius: 6px;
            background: var(--light);
            box-shadow: var(--shadow-sm);
        }

        .setor-item:hover {
            background-color: rgba(44, 125, 160, 0.05);
        }

        .setor-item.active {
            background-color: rgba(0, 0, 0, 0.03);
            border-left: 3px solid transparent;
        }

        .setor-name {
            font-weight: 600;
            margin-bottom: 5px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            color: var(--darker);
        }

        .pacientes-container {
            margin-top: 12px;
            padding-left: 10px;
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease;
            display: grid;
            grid-template-columns: 1fr;
            gap: 8px;
        }

        .setor-item.expanded .pacientes-container {
            max-height: 1000px;
        }

        .paciente-item {
            padding: 12px;
            border-bottom: 1px dashed var(--border);
            border-radius: 6px;
            transition: all 0.2s ease;
            background: var(--light);
            display: flex;
            align-items: center;
        }

        .paciente-item:hover {
            background-color: rgba(44, 125, 160, 0.05);
        }

        .paciente-item:last-child {
            border-bottom: none;
        }

        .paciente-info {
            flex: 1;
            min-width: 0;
        }

        .paciente-name {
            font-weight: 600;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            font-size: 0.95rem;
            margin-bottom: 4px;
            color: var(--darker);
        }

        .paciente-details {
            font-size: 0.82rem;
            color: var(--gray);
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
        }

        .badge {
            font-size: 0.75rem;
            padding: 3px 8px;
            border-radius: 10px;
            background-color: rgba(44, 125, 160, 0.1);
            color: var(--primary-dark);
            font-weight: 500;
        }

        .main-content {
            flex: 1;
            display: flex;
            flex-direction: column;
            overflow: hidden;
            box-shadow: var(--shadow-sm);
        }

        .patient-header {
            padding: 15px 20px;
            border-bottom: 1px solid var(--border);
            display: flex;
            align-items: center;
            justify-content: space-between;
            background: var(--light);
        }

        .patient-title {
            font-size: 1.2rem;
            font-weight: 700;
            color: var(--darker);
            letter-spacing: -0.3px;
        }

        .patient-details {
            display: flex;
            gap: 15px;
            font-size: 0.9rem;
            color: var(--dark);
            flex-wrap: wrap;
        }

        .detail-item {
            display: flex;
            align-items: center;
            gap: 5px;
            font-weight: 500;
        }

        .soap-tabs {
            display: flex;
            background-color: white;
            border-bottom: 1px solid var(--border);
            background: var(--light);
            overflow-x: auto;
        }

        .soap-tab {
            padding: 12px 20px;
            cursor: pointer;
            font-weight: 600;
            color: var(--gray);
            border-bottom: 3px solid transparent;
            transition: all 0.2s ease;
            font-size: 0.92rem;
            white-space: nowrap;
        }

        .soap-tab:hover {
            color: var(--darker);
            background: rgba(44, 125, 160, 0.05);
        }

        .soap-tab.active {
            color: var(--darker);
            border-bottom: 3px solid var(--darker);
            background: rgba(44, 125, 160, 0.08);
        }

        .editor-container {
            flex: 1;
            display: flex;
            flex-direction: column;
            overflow: hidden;
            background: var(--light);
        }

        .editor-content {
            flex: 1;
            display: none;
            flex-direction: column;
            padding: 15px;
            overflow: hidden;
        }

        .editor-content.active {
            display: flex;
        }

        .editor-header {
            margin-bottom: 12px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .editor-title {
            font-size: 1.1rem;
            font-weight: 700;
            color: var(--darker);
        }

        .quick-actions {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            justify-content: flex-end;
        }

        .quick-action {
            padding: 8px 12px;
            background: var(--light);
            border: 1px solid var(--border);
            border-radius: 6px;
            font-size: 0.85rem;
            cursor: pointer;
            transition: all 0.2s ease;
            font-weight: 500;
            box-shadow: var(--shadow-sm);
        }

        .quick-action:hover {
            background: rgba(44, 125, 160, 0.1);
            transform: translateY(-1px);
            box-shadow: var(--shadow-md);
        }

        .textarea-container {
            position: relative;
            flex: 1;
            min-height: 0;
            overflow: auto;
        }

        .soap-textarea {
            width: 100%;
            min-height: 150px;
            height: 100%;
            padding: 15px;
            border: 1px solid var(--border);
            border-radius: 6px;
            resize: none;
            font-size: 1.05rem;
            line-height: 1.6;
            font-family: 'Inter', sans-serif;
            background: var(--light);
            transition: all 0.2s ease;
            box-shadow: var(--shadow-sm);
        }

        .soap-textarea:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 2px rgba(44, 125, 160, 0.2);
        }

        .editor-footer {
            padding: 12px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: var(--light);
            border-top: 1px solid var(--border);
            gap: 10px;
        }

        .signature {
            font-size: 0.85rem;
            color: var(--gray);
            display: flex;
            flex-direction: column;
        }

        .mobile-menu-btn {
            display: none;
            background: none;
            border: none;
            color: var(--darker);
            font-size: 1.4rem;
            cursor: pointer;
            margin-right: 12px;
            width: 30px;
            height: 30px;
            position: relative;
        }

        .hamburger, .hamburger:before, .hamburger:after {
            content: '';
            position: absolute;
            width: 100%;
            height: 2px;
            background: var(--darker);
            transition: all 0.3s ease;
            left: 0;
        }

        .hamburger {
            top: 50%;
            transform: translateY(-50%);
        }

        .hamburger:before {
            top: -8px;
        }

        .hamburger:after {
            top: 8px;
        }

        .mobile-menu-btn.open .hamburger {
            background: transparent;
        }

        .mobile-menu-btn.open .hamburger:before {
            transform: rotate(45deg);
            top: 0;
        }

        .mobile-menu-btn.open .hamburger:after {
            transform: rotate(-45deg);
            top: 0;
        }

        .modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.5);
            z-index: 1000;
            display: flex;
            justify-content: center;
            align-items: center;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
        }

        .modal.active {
            opacity: 1;
            visibility: visible;
        }

        .modal-content {
            width: 90%;
            max-width: 500px;
            max-height: 90vh;
            overflow-y: auto;
            padding: 25px;
            border-radius: 10px;
            transform: translateY(20px);
            transition: transform 0.3s ease;
            background: var(--light);
            box-shadow: var(--shadow-md);
        }

        .modal.active .modal-content {
            transform: translateY(0);
        }

        .modal-header {
            margin-bottom: 15px;
            padding-bottom: 12px;
            border-bottom: 1px solid var(--border);
        }

        .modal-title {
            font-size: 1.4rem;
            font-weight: 700;
            color: var(--darker);
        }

        .form-group {
            margin-bottom: 15px;
        }

        .form-group label {
            display: block;
            margin-bottom: 6px;
            font-weight: 600;
            color: var(--dark);
        }

        .form-control {
            width: 100%;
            padding: 10px 12px;
            border: 1px solid var(--border);
            border-radius: 6px;
            font-size: 0.95rem;
            font-family: 'Inter', sans-serif;
            background: var(--light);
            transition: all 0.2s ease;
            box-shadow: var(--shadow-sm);
        }

        .form-control:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 2px rgba(44, 125, 160, 0.2);
        }

        .modal-footer {
            display: flex;
            justify-content: flex-end;
            gap: 10px;
            margin-top: 15px;
        }

        .toast {
            position: fixed;
            bottom: 20px;
            right: 20px;
            padding: 16px 24px;
            border-radius: 8px;
            background: var(--darker);
            color: white;
            font-weight: 500;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            opacity: 0;
            transform: translateY(20px);
            transition: all 0.3s ease;
            z-index: 2000;
            max-width: 320px;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .toast:before {
            content: '✓';
            font-size: 1.2rem;
        }

        .toast.show {
            opacity: 1;
            transform: translateY(0);
        }

        .toast-success {
            background: var(--success);
        }

        .toast-error {
            background: var(--danger);
        }

        .toast-error:before {
            content: '!';
        }

        @media (max-width: 992px) {
            .sidebar {
                position: absolute;
                left: 0;
                top: var(--header-height);
                bottom: 0;
                z-index: 90;
                transform: translateX(-100%);
                width: 100%;
                max-width: 320px;
                box-shadow: var(--shadow-md);
            }

            .sidebar.open {
                transform: translateX(0);
            }

            .mobile-menu-btn {
                display: block;
            }

            .patient-details {
                flex-direction: row;
                gap: 5px;
            }

            .signature {
                display: none;
            }

            .sidebar .btn-pass {
                position: sticky;
                bottom: 10px;
                margin: 15px;
                z-index: 10;
            }
            
            #btnPassPlantao {
                display: none;
            }
        }

        @media (min-width: 993px) {
            #btnPassPlantaoMobile {
                display: none;
            }
        }

        @media (max-width: 576px) {
            :root {
                --sidebar-width: 260px;
                --header-height: 55px;
            }

            .container {
                padding: 8px;
                gap: 8px;
            }
            
            .logo {
                font-size: 1.3rem;
            }
            
            .header-info {
                font-size: 0.8rem;
            }
            
            .section-header {
                padding: 12px 10px;
            }
            
            .soap-tabs {
                overflow-x: auto;
                white-space: nowrap;
            }
            
            .soap-tab {
                padding: 10px 15px;
                font-size: 0.85rem;
            }
            
            .editor-content {
                padding: 12px;
            }
            
            .editor-header {
                flex-direction: column;
                align-items: flex-start;
                gap: 10px;
            }
            
            .quick-actions {
                width: 100%;
                justify-content: flex-start;
            }
            
            .patient-header {
                flex-direction: column;
                align-items: flex-start;
                gap: 8px;
                padding: 12px 15px;
            }
            
            .modal-content {
                width: 95%;
                padding: 20px;
            }
            
            .modal-title {
                font-size: 1.3rem;
            }
            
            .form-group {
                margin-bottom: 12px;
            }
        }

        ::-webkit-scrollbar {
            width: 6px;
            height: 6px;
        }

        ::-webkit-scrollbar-track {
            background: rgba(0,0,0,0.05);
            border-radius: 8px;
        }

        ::-webkit-scrollbar-thumb {
            background: rgba(44, 125, 160, 0.3);
            border-radius: 8px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: rgba(44, 125, 160, 0.5);
        }
        
        .save-indicator {
            position: absolute;
            bottom: 10px;
            right: 10px;
            font-size: 0.75rem;
            color: var(--success);
            opacity: 0;
            transition: opacity 0.3s;
        }
        
        .save-indicator.show {
            opacity: 1;
        }
    </style>
</head>
<body>
    <div class="toast" id="toast">
        <span id="toast-message">Operação realizada com sucesso!</span>
    </div>

    <header>
        <button class="mobile-menu-btn" id="mobileMenuBtn">
            <span class="hamburger"></span>
        </button>
        <div class="logo">
            DONTMED
        </div>
        <div class="header-info">
            <div class="user-info">
                <span>Dr. Carlos Silva</span>
            </div>
            <div class="time-info">
                <span id="currentTime">00:00</span>
            </div>
        </div>
    </header>

    <div class="container">
        <div class="sidebar card" id="sidebar">
            <div class="section-header">
                <div class="section-title">Setores</div>
                <button class="btn" id="btnNewSetor">
                    Novo
                </button>
            </div>
            
            <div class="search-container">
                <div class="search-box">
                    <input type="text" id="searchInput" placeholder="Buscar paciente ou setor...">
                </div>
            </div>
            
            <div class="scrollable-content" id="setoresList">
                <!-- Setores serão carregados aqui dinamicamente -->
            </div>
            
            <button class="btn btn-pass" id="btnPassPlantaoMobile">
                Passar Plantão
            </button>
        </div>

        <div class="main-content card">
            <div class="patient-header">
                <div class="patient-title" id="patientTitle">Selecione um paciente</div>
                <div class="patient-details" id="patientDetails">
                    <!-- Detalhes do paciente serão carregados aqui -->
                </div>
            </div>
            
            <div class="soap-tabs">
                <div class="soap-tab active" data-tab="subjetivo">Subjetivo</div>
                <div class="soap-tab" data-tab="objetivo">Objetivo</div>
                <div class="soap-tab" data-tab="avaliacao">Avaliação</div>
                <div class="soap-tab" data-tab="plano">Plano</div>
            </div>
            
            <div class="editor-container">
                <div class="editor-content active" id="subjetivo">
                    <div class="editor-header">
                        <div class="editor-title">Subjetivo</div>
                        <div class="quick-actions">
                            <div class="quick-action" data-text="Paciente relata melhora do quadro">
                                Melhora
                            </div>
                            <div class="quick-action" data-text="Paciente refere dor intensa">
                                Dor
                            </div>
                            <div class="quick-action" data-text="Paciente refere falta de ar">
                                Dispneia
                            </div>
                        </div>
                    </div>
                    <div class="textarea-container">
                        <textarea class="soap-textarea" id="subjetivo-text" placeholder="Descreva os sintomas e queixas relatadas pelo paciente..."></textarea>
                        <div class="save-indicator" id="saveIndicatorSubjetivo">Salvo</div>
                    </div>
                </div>
                
                <div class="editor-content" id="objetivo">
                    <div class="editor-header">
                        <div class="editor-title">Objetivo</div>
                        <div class="quick-actions">
                            <div class="quick-action" data-text="PA: 120/80 mmHg | FC: 78 bpm | FR: 16 rpm | Temp: 36.5°C">
                                Sinais Vitais
                            </div>
                            <div class="quick-action" data-text="Exame físico: abdômen flácido, indolor à palpação">
                                Exame Físico
                            </div>
                            <div class="quick-action" data-text="Exames laboratoriais dentro dos parâmetros normais">
                                Exames
                            </div>
                        </div>
                    </div>
                    <div class="textarea-container">
                        <textarea class="soap-textarea" id="objetivo-text" placeholder="Registre os achados objetivos do exame físico e exames complementares..."></textarea>
                        <div class="save-indicator" id="saveIndicatorObjetivo">Salvo</div>
                    </div>
                </div>
                
                <div class="editor-content" id="avaliacao">
                    <div class="editor-header">
                        <div class="editor-title">Avaliação</div>
                        <div class="quick-actions">
                            <div class="quick-action" data-text="Paciente estável, em melhora clínica">
                                Estável
                            </div>
                            <div class="quick-action" data-text="Paciente instável, necessita monitorização contínua">
                                Instável
                            </div>
                            <div class="quick-action" data-text="Suspeita de infecção, iniciar antibioticoterapia">
                                Infecção
                            </div>
                        </div>
                    </div>
                    <div class="textarea-container">
                        <textarea class="soap-textarea" id="avaliacao-text" placeholder="Faça sua avaliação diagnóstica e análise do quadro clínico..."></textarea>
                        <div class="save-indicator" id="saveIndicatorAvaliacao">Salvo</div>
                    </div>
                </div>
                
                <div class="editor-content" id="plano">
                    <div class="editor-header">
                        <div class="editor-title">Plano</div>
                        <div class="quick-actions">
                            <div class="quick-action" data-text="Manter tratamento atual">
                                Manter
                            </div>
                            <div class="quick-action" data-text="Solicitar novos exames laboratoriais">
                                Exames
                            </div>
                            <div class="quick-action" data-text="Encaminhar para especialista">
                                Encaminhar
                            </div>
                        </div>
                    </div>
                    <div class="textarea-container">
                        <textarea class="soap-textarea" id="plano-text" placeholder="Descreva o plano terapêutico, condutas e orientações..."></textarea>
                        <div class="save-indicator" id="saveIndicatorPlano">Salvo</div>
                    </div>
                </div>
            </div>
            
            <div class="editor-footer">
                <div class="signature">
                    <span id="signatureName">Assinado digitalmente por: Dr. Carlos Silva</span>
                    <span id="editTimestamp">25/06/2023 14:30</span>
                </div>
                <button class="btn btn-pass" id="btnPassPlantao">
                    Passar Plantão
                </button>
            </div>
        </div>
    </div>

    <div class="modal" id="passPlantaoModal">
        <div class="modal-content card">
            <div class="modal-header">
                <h2 class="modal-title">Passagem de Plantão</h2>
            </div>
            
            <div>
                <div class="form-group">
                    <label>Médico que recebe o plantão</label>
                    <input type="text" class="form-control" id="medicoRecebe" placeholder="Nome do médico">
                </div>
                
                <h3 style="margin: 20px 0 15px; font-size: 1.1rem; font-weight: 600;">Checklist de Passagem</h3>
                <div style="display: flex; flex-direction: column; gap: 12px; margin-bottom: 25px;">
                    <label style="display: flex; align-items: center; gap: 12px;">
                        <input type="checkbox" style="width: 20px; height: 20px; accent-color: var(--darker);">
                        <span>Todos os pacientes foram visitados</span>
                    </label>
                    <label style="display: flex; align-items: center; gap: 12px;">
                        <input type="checkbox" style="width: 20px; height: 20px; accent-color: var(--darker);">
                        <span>Plantão repassado para o médico seguinte</span>
                    </label>
                    <label style="display: flex; align-items: center; gap: 12px;">
                        <input type="checkbox" style="width: 20px; height: 20px; accent-color: var(--darker);">
                        <span>Todas as prescrições foram atualizadas</span>
                    </label>
                    <label style="display: flex; align-items: center; gap: 12px;">
                        <input type="checkbox" style="width: 20px; height: 20px; accent-color: var(--darker);">
                        <span>Documentação completa de todos os atendimentos</span>
                    </label>
                </div>
                
                <div class="form-group">
                    <label>Assinatura Digital</label>
                    <input type="text" class="form-control" id="assinatura" readonly>
                </div>
            </div>
            
            <div class="modal-footer">
                <button class="btn" id="btnCancelPass" style="background: rgba(0,0,0,0.08); color: var(--dark);">
                    Cancelar
                </button>
                <button class="btn btn-success" id="btnConfirmPass">
                    Confirmar Passagem
                </button>
            </div>
        </div>
    </div>

    <div class="modal" id="newSetorModal">
        <div class="modal-content card">
            <div class="modal-header">
                <h2 class="modal-title">Adicionar Novo Setor</h2>
            </div>
            
            <div class="form-group">
                <label>Nome do Setor</label>
                <input type="text" class="form-control" id="setorName" placeholder="Ex: UTI Adulto, Emergência">
            </div>
            
            <div class="modal-footer">
                <button class="btn" id="btnCancelSetor" style="background: rgba(0,0,0,0.08); color: var(--dark);">
                    Cancelar
                </button>
                <button class="btn btn-success" id="btnSaveSetor">
                    Salvar Setor
                </button>
            </div>
        </div>
    </div>

    <div class="modal" id="newPacienteModal">
        <div class="modal-content card">
            <div class="modal-header">
                <h2 class="modal-title">Adicionar Novo Paciente</h2>
            </div>
            
            <div class="form-group">
                <label>Nome Completo</label>
                <input type="text" class="form-control" id="pacienteName" placeholder="Nome do paciente">
            </div>
            
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-bottom: 20px;">
                <div class="form-group">
                    <label>Idade</label>
                    <input type="number" class="form-control" id="pacienteIdade" placeholder="Idade">
                </div>
                
                <div class="form-group">
                    <label>Sexo Biológico</label>
                    <select class="form-control" id="pacienteSexo">
                        <option value="">Selecione</option>
                        <option value="M">Masculino</option>
                        <option value="F">Feminino</option>
                    </select>
                </div>
            </div>
            
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-bottom: 20px;">
                <div class="form-group">
                    <label>Leito</label>
                    <input type="text" class="form-control" id="pacienteLeito" placeholder="Número do leito">
                </div>
                
                <div class="form-group">
                    <label>Nº Atendimento</label>
                    <input type="text" class="form-control" id="pacienteAtendimento" placeholder="Número do atendimento">
                </div>
            </div>
            
            <div class="modal-footer">
                <button class="btn" id="btnCancelPaciente" style="background: rgba(0,0,0,0.08); color: var(--dark);">
                    Cancelar
                </button>
                <button class="btn btn-success" id="btnSavePaciente">
                    Adicionar Paciente
                </button>
            </div>
        </div>
    </div>

    <script>
        const dados = {
            setores: [
                {
                    id: 1,
                    nome: "UTI Adulto",
                    pacientes: [
                        {
                            id: 101,
                            nome: "Maria Oliveira",
                            idade: 68,
                            sexo: "F",
                            leito: "12A",
                            atendimento: "2023001",
                            soap: {
                                subjetivo: "Paciente relata dor torácica intensa e falta de ar.",
                                objetivo: "PA: 150/90 mmHg | FC: 110 bpm | FR: 24 rpm | Temp: 37.2°C",
                                avaliacao: "Suspeita de SCA. ECG com supradesnivelamento de ST em parede anterior.",
                                plano: "Solicitar troponina, iniciar protocolo de SCA, monitorização contínua."
                            },
                            historico: [
                                {
                                    timestamp: "25/06/2023 10:15",
                                    medico: "Dr. Carlos Silva",
                                    acao: "Registro inicial criado"
                                }
                            ]
                        },
                        {
                            id: 102,
                            nome: "Carlos Santos",
                            idade: 55,
                            sexo: "M",
                            leito: "15B",
                            atendimento: "2023002",
                            soap: {
                                subjetivo: "Paciente refere tosse produtiva e febre há 3 dias.",
                                objetivo: "PA: 130/80 mmHg | FC: 92 bpm | FR: 20 rpm | Temp: 38.5°C | Sat: 92% RA",
                                avaliacao: "PAC provável. Rx tórax com consolidação em LSD.",
                                plano: "Iniciar antibioticoterapia, solicitar hemoculturas, oxigenoterapia."
                            },
                            historico: [
                                {
                                    timestamp: "25/06/2023 10:30",
                                    medico: "Dr. Carlos Silva",
                                    acao: "Registro inicial criado"
                                }
                            ]
                        }
                    ]
                },
                {
                    id: 2,
                    nome: "Emergência",
                    pacientes: [
                        {
                            id: 201,
                            nome: "João Pereira",
                            idade: 42,
                            sexo: "M",
                            leito: "5",
                            atendimento: "2023003",
                            soap: {
                                subjetivo: "Paciente relata dor abdominal intensa em cólica há 6 horas.",
                                objetivo: "PA: 140/90 mmHg | FC: 100 bpm | Abdome distendido, doloroso à palpação",
                                avaliacao: "Abdome agudo obstrutivo. Suspeita de cólica renal.",
                                plano: "Solicitar USG abdome, analgesia, hidratação venosa."
                            },
                            historico: [
                                {
                                    timestamp: "25/06/2023 11:05",
                                    medico: "Dr. Carlos Silva",
                                    acao: "Registro inicial criado"
                                }
                            ]
                        },
                        {
                            id: 202,
                            nome: "Ana Costa",
                            idade: 35,
                            sexo: "F",
                            leito: "8",
                            atendimento: "2023004",
                            soap: {
                                subjetivo: "Paciente refere cefaleia intensa e vômitos.",
                                objetivo: "PA: 160/100 mmHg | FC: 88 bpm | Neurologico: GCS 15, sem déficits focais",
                                avaliacao: "Crise hipertensiva, cefaleia secundária.",
                                plano: "Redução gradual de PA, analgesia, monitorização neurológica."
                            },
                            historico: [
                                {
                                    timestamp: "25/06/2023 11:20",
                                    medico: "Dr. Carlos Silva",
                                    acao: "Registro inicial criado"
                                }
                            ]
                        }
                    ]
                },
                {
                    id: 3,
                    nome: "Enfermaria Clínica",
                    pacientes: [
                        {
                            id: 301,
                            nome: "Pedro Almeida",
                            idade: 72,
                            sexo: "M",
                            leito: "22C",
                            atendimento: "2023005",
                            soap: {
                                subjetivo: "Paciente relata melhora da dispneia, ainda com tosse.",
                                objetivo: "PA: 120/70 mmHg | FC: 80 bpm | FR: 18 rpm | Temp: 36.8°C | Sat: 96% O2 2L",
                                avaliacao: "PAC em resolução, quadro estável.",
                                plano: "Continuar antibioticoterapia, iniciar fisioterapia respiratória."
                            },
                            historico: [
                                {
                                    timestamp: "25/06/2023 11:45",
                                    medico: "Dr. Carlos Silva",
                                    acao: "Registro inicial criado"
                                }
                            ]
                        }
                    ]
                }
            ],
            historico: []
        };

        const DOM = {
            sidebar: document.getElementById('sidebar'),
            mobileMenuBtn: document.getElementById('mobileMenuBtn'),
            setoresList: document.getElementById('setoresList'),
            btnNewSetor: document.getElementById('btnNewSetor'),
            patientTitle: document.getElementById('patientTitle'),
            patientDetails: document.getElementById('patientDetails'),
            searchInput: document.getElementById('searchInput'),
            soapTabs: document.querySelectorAll('.soap-tab'),
            editorContents: document.querySelectorAll('.editor-content'),
            textareas: {
                subjetivo: document.getElementById('subjetivo-text'),
                objetivo: document.getElementById('objetivo-text'),
                avaliacao: document.getElementById('avaliacao-text'),
                plano: document.getElementById('plano-text')
            },
            saveIndicators: {
                subjetivo: document.getElementById('saveIndicatorSubjetivo'),
                objetivo: document.getElementById('saveIndicatorObjetivo'),
                avaliacao: document.getElementById('saveIndicatorAvaliacao'),
                plano: document.getElementById('saveIndicatorPlano')
            },
            btnPassPlantao: document.getElementById('btnPassPlantao'),
            btnPassPlantaoMobile: document.getElementById('btnPassPlantaoMobile'),
            passPlantaoModal: document.getElementById('passPlantaoModal'),
            btnCancelPass: document.getElementById('btnCancelPass'),
            btnConfirmPass: document.getElementById('btnConfirmPass'),
            medicoRecebe: document.getElementById('medicoRecebe'),
            assinatura: document.getElementById('assinatura'),
            toast: document.getElementById('toast'),
            toastMessage: document.getElementById('toast-message'),
            newSetorModal: document.getElementById('newSetorModal'),
            setorName: document.getElementById('setorName'),
            btnCancelSetor: document.getElementById('btnCancelSetor'),
            btnSaveSetor: document.getElementById('btnSaveSetor'),
            newPacienteModal: document.getElementById('newPacienteModal'),
            pacienteName: document.getElementById('pacienteName'),
            pacienteIdade: document.getElementById('pacienteIdade'),
            pacienteSexo: document.getElementById('pacienteSexo'),
            pacienteLeito: document.getElementById('pacienteLeito'),
            pacienteAtendimento: document.getElementById('pacienteAtendimento'),
            btnCancelPaciente: document.getElementById('btnCancelPaciente'),
            btnSavePaciente: document.getElementById('btnSavePaciente'),
            signatureName: document.getElementById('signatureName'),
            editTimestamp: document.getElementById('editTimestamp')
        };

        let state = {
            currentSetor: null,
            currentPaciente: null,
            currentDoctor: "Dr. Carlos Silva",
            lastEdit: new Date().toISOString()
        };

        function init() {
            renderSetores();
            setupEventListeners();
            updateTime();
            setInterval(updateTime, 60000);
            setInterval(saveCurrentData, 30000);
            updateSignature();
        }

        function renderSetores() {
            DOM.setoresList.innerHTML = '';
            
            dados.setores.forEach(setor => {
                const isExpanded = state.currentSetor === setor.id;
                
                const setorEl = document.createElement('div');
                setorEl.className = `setor-item ${isExpanded ? 'expanded' : ''} ${state.currentSetor === setor.id ? 'active' : ''}`;
                setorEl.innerHTML = `
                    <div class="setor-name">
                        <span>${setor.nome}</span>
                        <span>${setor.pacientes.length} paciente${setor.pacientes.length !== 1 ? 's' : ''}</span>
                    </div>
                    <div class="pacientes-container">
                        ${setor.pacientes.map(paciente => `
                            <div class="paciente-item ${state.currentPaciente === paciente.id ? 'active' : ''}" data-id="${paciente.id}">
                                <div class="paciente-info">
                                    <div class="paciente-name">${paciente.nome}</div>
                                    <div class="paciente-details">
                                        <span>${paciente.idade} anos</span>
                                        <span class="badge">${paciente.leito}</span>
                                        <span class="badge">${paciente.atendimento}</span>
                                    </div>
                                </div>
                            </div>
                        `).join('')}
                        <button class="btn" style="margin-top: 10px; width: 100%;" data-setor="${setor.id}">
                            Adicionar Paciente
                        </button>
                    </div>
                `;
                
                setorEl.addEventListener('click', (e) => {
                    if (!e.target.closest('.paciente-item') && !e.target.closest('button')) {
                        if (state.currentSetor === setor.id) {
                            state.currentSetor = null;
                        } else {
                            state.currentSetor = setor.id;
                        }
                        renderSetores();
                    }
                });
                
                DOM.setoresList.appendChild(setorEl);
                
                setorEl.querySelectorAll('.paciente-item').forEach(item => {
                    item.addEventListener('click', () => {
                        const pacienteId = parseInt(item.getAttribute('data-id'));
                        selectPaciente(pacienteId);
                    });
                });
                
                setorEl.querySelector('button').addEventListener('click', (e) => {
                    e.stopPropagation();
                    openNewPacienteModal(setor.id);
                });
            });
        }

        function selectPaciente(pacienteId) {
            let paciente = null;
            let setor = null;
            
            for (const s of dados.setores) {
                paciente = s.pacientes.find(p => p.id === pacienteId);
                if (paciente) {
                    setor = s;
                    break;
                }
            }
            
            if (!paciente) return;
            
            state.currentSetor = setor.id;
            state.currentPaciente = paciente.id;
            
            DOM.patientTitle.textContent = paciente.nome;
            DOM.patientDetails.innerHTML = `
                <div class="detail-item">${paciente.idade} anos, ${paciente.sexo === 'M' ? 'Masculino' : 'Feminino'}</div>
                <div class="detail-item">Leito: ${paciente.leito}</div>
                <div class="detail-item">Atendimento: ${paciente.atendimento}</div>
            `;
            
            DOM.textareas.subjetivo.value = paciente.soap.subjetivo;
            DOM.textareas.objetivo.value = paciente.soap.objetivo;
            DOM.textareas.avaliacao.value = paciente.soap.avaliacao;
            DOM.textareas.plano.value = paciente.soap.plano;
            
            updateSignature();
            renderSetores();
            
            if (window.innerWidth <= 992) {
                DOM.sidebar.classList.remove('open');
                DOM.mobileMenuBtn.classList.remove('open');
            }
        }

        function setupEventListeners() {
            DOM.mobileMenuBtn.addEventListener('click', () => {
                DOM.sidebar.classList.toggle('open');
                DOM.mobileMenuBtn.classList.toggle('open');
            });
            
            DOM.btnNewSetor.addEventListener('click', openNewSetorModal);
            
            DOM.soapTabs.forEach(tab => {
                tab.addEventListener('click', () => {
                    const tabId = tab.getAttribute('data-tab');
                    openTab(tabId);
                });
            });
            
            document.querySelectorAll('.quick-action').forEach(action => {
                action.addEventListener('click', function() {
                    const tabId = this.closest('.editor-content').id;
                    const textarea = DOM.textareas[tabId];
                    const textToAdd = this.getAttribute('data-text');
                    
                    textarea.value = textToAdd + '\n\n' + textarea.value;
                    textarea.focus();
                    
                    registerAction(`Template adicionado em ${tabId}`);
                    saveCurrentData();
                });
            });
            
            function openPassPlantaoModal() {
                const now = new Date();
                DOM.assinatura.value = `${state.currentDoctor} - ${now.toLocaleString('pt-BR')}`;
                DOM.passPlantaoModal.classList.add('active');
            }

            DOM.btnPassPlantao.addEventListener('click', openPassPlantaoModal);
            DOM.btnPassPlantaoMobile.addEventListener('click', openPassPlantaoModal);
            
            DOM.btnCancelPass.addEventListener('click', () => {
                DOM.passPlantaoModal.classList.remove('active');
            });
            
            DOM.btnConfirmPass.addEventListener('click', () => {
                const medicoRecebe = DOM.medicoRecebe.value.trim();
                
                if (!medicoRecebe) {
                    showToast('Informe o médico que receberá o plantão', 'error');
                    return;
                }
                
                const plantao = {
                    data: new Date().toISOString(),
                    medicoRecebe: medicoRecebe,
                    assinatura: DOM.assinatura.value,
                    setores: JSON.parse(JSON.stringify(dados.setores))
                };
                
                dados.historico.push(plantao);
                registerAction(`Plantão passado para ${medicoRecebe} por ${state.currentDoctor}`);
                showToast(`Plantão passado para ${medicoRecebe} com sucesso!`, 'success');
                DOM.passPlantaoModal.classList.remove('active');
                DOM.medicoRecebe.value = '';
            });
            
            DOM.btnCancelSetor.addEventListener('click', () => {
                DOM.newSetorModal.classList.remove('active');
            });
            
            DOM.btnSaveSetor.addEventListener('click', () => {
                const nomeSetor = DOM.setorName.value.trim();
                if (nomeSetor) {
                    const novoSetor = {
                        id: Date.now(),
                        nome: nomeSetor,
                        pacientes: []
                    };
                    dados.setores.push(novoSetor);
                    renderSetores();
                    DOM.newSetorModal.classList.remove('active');
                    DOM.setorName.value = '';
                    registerAction(`Novo setor criado: ${nomeSetor}`);
                    showToast(`Setor "${nomeSetor}" criado com sucesso!`, 'success');
                } else {
                    showToast('Por favor, informe o nome do setor', 'error');
                }
            });
            
            DOM.btnCancelPaciente.addEventListener('click', () => {
                DOM.newPacienteModal.classList.remove('active');
            });
            
            DOM.btnSavePaciente.addEventListener('click', () => {
                const nome = DOM.pacienteName.value.trim();
                const idade = parseInt(DOM.pacienteIdade.value);
                const sexo = DOM.pacienteSexo.value;
                const leito = DOM.pacienteLeito.value.trim();
                const atendimento = DOM.pacienteAtendimento.value.trim();
                
                if (!nome || isNaN(idade) || !sexo || !leito || !atendimento) {
                    showToast('Por favor, preencha todos os campos', 'error');
                    return;
                }
                
                const setorId = parseInt(DOM.newPacienteModal.getAttribute('data-setor'));
                const setor = dados.setores.find(s => s.id === setorId);
                
                if (setor) {
                    const novoPaciente = {
                        id: Date.now(),
                        nome,
                        idade,
                        sexo,
                        leito,
                        atendimento,
                        soap: {
                            subjetivo: "",
                            objetivo: "",
                            avaliacao: "",
                            plano: ""
                        },
                        historico: [{
                            timestamp: new Date().toLocaleString('pt-BR'),
                            medico: state.currentDoctor,
                            acao: "Paciente adicionado ao sistema"
                        }]
                    };
                    
                    setor.pacientes.push(novoPaciente);
                    renderSetores();
                    DOM.newPacienteModal.classList.remove('active');
                    
                    DOM.pacienteName.value = '';
                    DOM.pacienteIdade.value = '';
                    DOM.pacienteSexo.value = '';
                    DOM.pacienteLeito.value = '';
                    DOM.pacienteAtendimento.value = '';
                    
                    registerAction(`Novo paciente adicionado: ${nome}`);
                    showToast(`Paciente "${nome}" adicionado com sucesso!`, 'success');
                }
            });
            
            Object.values(DOM.textareas).forEach(textarea => {
                textarea.addEventListener('input', () => {
                    const tabId = textarea.id.split('-')[0];
                    showSaveIndicator(tabId);
                    
                    clearTimeout(textarea.saveTimeout);
                    textarea.saveTimeout = setTimeout(() => {
                        saveCurrentData();
                    }, 1000);
                });
            });
        }

        function openTab(tabId) {
            DOM.soapTabs.forEach(tab => tab.classList.remove('active'));
            DOM.editorContents.forEach(content => content.classList.remove('active'));
            
            document.querySelector(`.soap-tab[data-tab="${tabId}"]`).classList.add('active');
            document.getElementById(tabId).classList.add('active');
        }

        function saveCurrentData() {
            if (!state.currentPaciente) return;
            
            for (const setor of dados.setores) {
                const paciente = setor.pacientes.find(p => p.id === state.currentPaciente);
                if (paciente) {
                    const changes = [];
                    if (paciente.soap.subjetivo !== DOM.textareas.subjetivo.value) {
                        changes.push("Subjetivo");
                    }
                    if (paciente.soap.objetivo !== DOM.textareas.objetivo.value) {
                        changes.push("Objetivo");
                    }
                    if (paciente.soap.avaliacao !== DOM.textareas.avaliacao.value) {
                        changes.push("Avaliação");
                    }
                    if (paciente.soap.plano !== DOM.textareas.plano.value) {
                        changes.push("Plano");
                    }
                    
                    if (changes.length > 0) {
                        showToast('Dados salvos automaticamente', 'success');
                    }
                    
                    paciente.soap.subjetivo = DOM.textareas.subjetivo.value;
                    paciente.soap.objetivo = DOM.textareas.objetivo.value;
                    paciente.soap.avaliacao = DOM.textareas.avaliacao.value;
                    paciente.soap.plano = DOM.textareas.plano.value;
                    
                    state.lastEdit = new Date().toISOString();
                    updateSignature();
                    
                    break;
                }
            }
        }

        function showSaveIndicator(tabId) {
            const indicator = DOM.saveIndicators[tabId];
            indicator.classList.add('show');
            
            setTimeout(() => {
                indicator.classList.remove('show');
            }, 2000);
        }

        function updateSignature() {
            if (state.lastEdit) {
                const editDate = new Date(state.lastEdit);
                DOM.editTimestamp.textContent = editDate.toLocaleString('pt-BR');
            }
            DOM.signatureName.textContent = `Assinado digitalmente por: ${state.currentDoctor}`;
        }

        function openNewSetorModal() {
            DOM.newSetorModal.classList.add('active');
            DOM.setorName.focus();
        }

        function openNewPacienteModal(setorId) {
            DOM.newPacienteModal.setAttribute('data-setor', setorId);
            DOM.newPacienteModal.classList.add('active');
            DOM.pacienteName.focus();
        }

        function updateTime() {
            const now = new Date();
            const timeString = now.toLocaleTimeString('pt-BR', {
                hour: '2-digit',
                minute: '2-digit'
            });
            document.getElementById('currentTime').textContent = timeString;
        }

        function showToast(message, type = 'success') {
            DOM.toast.className = `toast ${type === 'error' ? 'toast-error' : 'toast-success'}`;
            DOM.toastMessage.textContent = message;
            DOM.toast.classList.add('show');
            
            setTimeout(() => {
                DOM.toast.classList.remove('show');
            }, 3000);
        }

        function registerAction(action) {
            const now = new Date();
            const timestamp = now.toLocaleString('pt-BR');
            
            if (state.currentPaciente) {
                for (const setor of dados.setores) {
                    const paciente = setor.pacientes.find(p => p.id === state.currentPaciente);
                    if (paciente) {
                        paciente.historico.push({
                            timestamp,
                            medico: state.currentDoctor,
                            acao: action
                        });
                        break;
                    }
                }
            }
            
            state.lastEdit = now.toISOString();
            updateSignature();
        }

        document.addEventListener('DOMContentLoaded', init);
    </script>
</body>
</html>